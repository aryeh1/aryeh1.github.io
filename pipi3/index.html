<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>יוכבד רבינוביץ | מערכת מומחים לשינה</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Heebo', sans-serif; background-color: #f8fafc; }
        .fade-enter { opacity: 0; transform: translateY(10px); }
        .fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity 300ms, transform 300ms; }
        .active-nav { color: #4f46e5; font-weight: 700; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c7c7c7; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        
        /* Loading Animation */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #4f46e5; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- Navbar -->
    <nav class="bg-white shadow-sm z-50 flex-shrink-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center cursor-pointer" onclick="navigate('home')">
                    <i data-lucide="moon" class="w-6 h-6 text-indigo-600 ml-2"></i>
                    <span class="font-bold text-xl tracking-tight">יוכבד רבינוביץ</span>
                </div>
                <div class="hidden md:flex items-center space-x-8 space-x-reverse">
                    <a onclick="navigate('home')" class="nav-item cursor-pointer text-slate-500 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">ראשי</a>
                    <a onclick="navigate('quiz')" class="nav-item cursor-pointer text-slate-500 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">אבחון התאמה</a>
                    <a onclick="navigate('store')" class="nav-item cursor-pointer text-slate-500 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">חנות הערכות</a>
                    <a onclick="navigate('builder')" class="nav-item cursor-pointer text-slate-500 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">הרכבה אישית</a>
                    <a onclick="navigate('about')" class="nav-item cursor-pointer text-slate-500 hover:text-indigo-600 px-3 py-2 text-sm font-medium transition-colors">מי אנחנו</a>
                </div>
                <div class="flex items-center">
                    <button onclick="toggleCart()" class="relative p-2 text-slate-400 hover:text-indigo-600 transition-colors">
                        <i data-lucide="shopping-cart" class="w-6 h-6"></i>
                        <span id="cart-badge" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/4 -translate-y-1/4 bg-red-600 rounded-full opacity-0 transition-opacity">0</span>
                    </button>
                    <!-- Mobile menu button -->
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="md:hidden mr-4 p-2 text-slate-400">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-slate-100 absolute w-full shadow-lg">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a onclick="navigate('home'); toggleMobileMenu()" class="block px-3 py-2 text-base font-medium text-slate-700 hover:bg-slate-50 rounded-md">ראשי</a>
                <a onclick="navigate('quiz'); toggleMobileMenu()" class="block px-3 py-2 text-base font-medium text-slate-700 hover:bg-slate-50 rounded-md">אבחון</a>
                <a onclick="navigate('store'); toggleMobileMenu()" class="block px-3 py-2 text-base font-medium text-slate-700 hover:bg-slate-50 rounded-md">חנות</a>
                <a onclick="navigate('builder'); toggleMobileMenu()" class="block px-3 py-2 text-base font-medium text-slate-700 hover:bg-slate-50 rounded-md">הרכבה אישית</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main id="app" class="flex-1 overflow-y-auto relative bg-slate-50">
        <!-- Content injected here via JS -->
    </main>

    <!-- Cart Sidebar (Drawer) -->
    <div id="cart-drawer" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50 transition-opacity" onclick="toggleCart()"></div>
        <div class="absolute inset-y-0 left-0 max-w-md w-full bg-white shadow-xl transform transition-transform translate-x-full duration-300 flex flex-col">
            <div class="px-4 py-6 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
                <h2 class="text-lg font-medium text-slate-900">סל הקניות שלי</h2>
                <button onclick="toggleCart()" class="text-slate-400 hover:text-slate-500">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="cart-items" class="flex-1 overflow-y-auto p-4 space-y-4">
                <!-- Cart Items Injected Here -->
                <div class="text-center text-slate-500 mt-10">הסל ריק כרגע</div>
            </div>
            <div class="border-t border-slate-200 p-4 bg-slate-50">
                <div class="flex justify-between text-base font-medium text-slate-900 mb-4">
                    <p>סה"כ לתשלום</p>
                    <p id="cart-total">0 ₪</p>
                </div>
                <button onclick="checkout()" class="w-full flex justify-center items-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700">
                    מעבר לתשלום (טלפוני)
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-5 left-5 bg-slate-800 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 transition-transform duration-300 z-50 flex items-center gap-3">
        <i data-lucide="check-circle" class="w-5 h-5 text-green-400"></i>
        <span id="toast-message">הודעה</span>
    </div>

    <script>
        // --- STATE MANAGEMENT ---
        const state = {
            currentPage: 'home',
            cart: [],
            quizAnswers: {},
            products: [
                { id: 1, name: 'ערכת בייסיק', price: 250, desc: 'זמזם + טבלה + הוראות', tag: 'הכי נמכר' },
                { id: 2, name: 'ערכת פרימיום', price: 320, desc: 'הכל + ליווי אישי בוואטסאפ למשך חודש', tag: 'מומלץ' },
                { id: 3, name: 'ערכת תאומים', price: 450, desc: 'שני מכשירים במחיר מוזל', tag: 'חסכוני' },
                { id: 4, name: 'ערכת לילה שקט VIP', price: 550, desc: 'ליווי טלפוני מלא, ספר ילדים, ומכשיר מתקדם', tag: 'הכל כלול' },
                { id: 5, name: 'זמזם בלבד', price: 180, desc: 'ללא תוספות וללא טבלאות', tag: null }
            ],
            addons: [
                { id: 101, name: 'ספר ילדים "הלילה היבש שלי"', price: 45 },
                { id: 102, name: 'סוללות ספייר (מארז כפול)', price: 20 },
                { id: 103, name: 'טבלת כוכבים נוספת', price: 15 },
                { id: 104, name: 'מגן מזרן איכותי', price: 80 }
            ]
        };

        // --- ROUTER & RENDER ENGINE ---
        function navigate(page, params = null) {
            state.currentPage = page;
            const app = document.getElementById('app');
            
            // Fade out effect could be added here
            app.innerHTML = '';
            window.scrollTo(0, 0);

            let content = '';
            switch(page) {
                case 'home': content = renderHome(); break;
                case 'quiz': content = renderQuiz(); break;
                case 'quizResult': content = renderQuizResult(); break;
                case 'store': content = renderStore(params); break;
                case 'builder': content = renderBuilder(); break;
                case 'about': content = renderAbout(); break;
                default: content = renderHome();
            }

            app.innerHTML = `<div class="fade-enter fade-enter-active">${content}</div>`;
            lucide.createIcons();
            updateActiveNav();
        }

        function updateActiveNav() {
            document.querySelectorAll('.nav-item').forEach(el => {
                if(el.getAttribute('onclick').includes(state.currentPage)) {
                    el.classList.add('text-indigo-600', 'font-bold');
                    el.classList.remove('text-slate-500');
                } else {
                    el.classList.remove('text-indigo-600', 'font-bold');
                    el.classList.add('text-slate-500');
                }
            });
        }

        // --- PAGES COMPONENTS ---

        function renderHome() {
            return `
                <div class="relative bg-white overflow-hidden">
                    <div class="max-w-7xl mx-auto">
                        <div class="relative z-10 pb-8 bg-white sm:pb-16 md:pb-20 lg:max-w-2xl lg:w-full lg:pb-28 xl:pb-32">
                            <main class="mt-10 mx-auto max-w-7xl px-4 sm:mt-12 sm:px-6 md:mt-16 lg:mt-20 lg:px-8 xl:mt-28">
                                <div class="sm:text-center lg:text-right">
                                    <h1 class="text-4xl tracking-tight font-extrabold text-slate-900 sm:text-5xl md:text-6xl">
                                        <span class="block xl:inline">הטכנולוגיה לשירות</span>
                                        <span class="block text-indigo-600 xl:inline">השינה של ילדך</span>
                                    </h1>
                                    <p class="mt-3 text-base text-slate-500 sm:mt-5 sm:text-lg sm:max-w-xl sm:mx-auto md:mt-5 md:text-xl lg:mx-0">
                                        במקום לנחש, תני למערכת המומחים שלנו לאבחן את המצב ולהציע את הפתרון המדויק. 
                                        שילוב של מכשור מתקדם, ליווי אנושי ואלגוריתם חכם.
                                    </p>
                                    <div class="mt-5 sm:mt-8 sm:flex sm:justify-center lg:justify-start gap-4">
                                        <div class="rounded-md shadow">
                                            <button onclick="navigate('quiz')" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 md:py-4 md:text-lg">
                                                <i data-lucide="activity" class="ml-2 w-5 h-5"></i>
                                                התחלי אבחון אונליין
                                            </button>
                                        </div>
                                        <div class="mt-3 sm:mt-0 sm:ml-3">
                                            <button onclick="navigate('store')" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 md:py-4 md:text-lg">
                                                לצפייה בחבילות
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </main>
                        </div>
                    </div>
                    <div class="lg:absolute lg:inset-y-0 lg:left-0 lg:w-1/2 bg-slate-100 flex items-center justify-center">
                        <div class="p-12 opacity-80">
                           <!-- Abstract UI Representation -->
                           <div class="grid grid-cols-2 gap-4">
                               <div class="bg-white p-6 rounded-2xl shadow-lg transform rotate-3">
                                   <i data-lucide="bar-chart-2" class="w-10 h-10 text-green-500 mb-2"></i>
                                   <div class="h-2 w-24 bg-slate-200 rounded mb-2"></div>
                                   <div class="h-2 w-16 bg-slate-200 rounded"></div>
                               </div>
                               <div class="bg-white p-6 rounded-2xl shadow-lg transform -rotate-2 mt-8">
                                   <i data-lucide="shield-check" class="w-10 h-10 text-indigo-500 mb-2"></i>
                                   <div class="h-2 w-24 bg-slate-200 rounded mb-2"></div>
                                   <div class="h-2 w-16 bg-slate-200 rounded"></div>
                               </div>
                           </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- QUIZ LOGIC ---
        let quizStep = 0;
        const quizQuestions = [
            { q: "בן כמה הילד/ה?", opts: ["מתחת לגיל 4", "גילאי 4-6", "גילאי 7-10", "מעל גיל 10"] },
            { q: "האם השינה עמוקה במיוחד?", opts: ["כן, לא מתעורר מכלום", "רגילה", "שינה קלה"] },
            { q: "באיזו תדירות מתרחשת הרטבה?", opts: ["כל לילה", "3-4 פעמים בשבוע", "פעם בשבוע", "לעיתים רחוקות"] },
            { q: "האם ניסיתם טיפול תרופתי בעבר?", opts: ["כן", "לא"] }
        ];

        function renderQuiz() {
            const q = quizQuestions[quizStep];
            const progress = ((quizStep + 1) / quizQuestions.length) * 100;
            
            return `
                <div class="min-h-full flex flex-col justify-center py-12 sm:px-6 lg:px-8 bg-slate-50">
                    <div class="sm:mx-auto sm:w-full sm:max-w-md">
                        <div class="w-full bg-slate-200 rounded-full h-2.5 mb-6">
                            <div class="bg-indigo-600 h-2.5 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
                        </div>
                        <h2 class="mt-6 text-center text-3xl font-extrabold text-slate-900">
                            אבחון פרופיל שינה
                        </h2>
                        <p class="mt-2 text-center text-sm text-slate-600">
                            שאלה ${quizStep + 1} מתוך ${quizQuestions.length}
                        </p>
                    </div>

                    <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
                        <div class="bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10">
                            <h3 class="text-xl font-medium mb-6 text-slate-800">${q.q}</h3>
                            <div class="space-y-4">
                                ${q.opts.map((opt, idx) => `
                                    <button onclick="handleQuizAnswer('${opt}')" class="w-full text-right px-4 py-3 border border-slate-300 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all flex items-center justify-between group">
                                        <span class="text-slate-700 group-hover:text-indigo-700 font-medium">${opt}</span>
                                        <i data-lucide="chevron-left" class="w-4 h-4 text-slate-300 group-hover:text-indigo-500"></i>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function handleQuizAnswer(answer) {
            state.quizAnswers[quizStep] = answer;
            if (quizStep < quizQuestions.length - 1) {
                quizStep++;
                navigate('quiz');
            } else {
                // Show analyzing animation
                document.getElementById('app').innerHTML = `
                    <div class="h-full flex flex-col items-center justify-center">
                        <div class="loader mb-4"></div>
                        <h2 class="text-xl font-bold text-slate-700">מעבד נתונים...</h2>
                        <p class="text-slate-500">האלגוריתם מחשב את החבילה האופטימלית</p>
                    </div>
                `;
                setTimeout(() => {
                    quizStep = 0; // Reset for next time
                    navigate('quizResult');
                }, 2000);
            }
        }

        function renderQuizResult() {
            // Logic to determine recommendation (simplified)
            const isDeepSleeper = Object.values(state.quizAnswers).some(a => a.includes("לא מתעורר"));
            const recommendedId = isDeepSleeper ? 4 : 2; // VIP for deep sleepers, Premium for others
            const product = state.products.find(p => p.id === recommendedId);

            return `
                <div class="max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
                    <div class="bg-white shadow-xl rounded-2xl overflow-hidden border-t-4 border-indigo-500">
                        <div class="p-8 text-center">
                            <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-6">
                                <i data-lucide="check" class="w-8 h-8 text-green-600"></i>
                            </div>
                            <h2 class="text-3xl font-bold text-slate-900 mb-2">האבחון הסתיים בהצלחה</h2>
                            <p class="text-lg text-slate-600 mb-8 max-w-2xl mx-auto">
                                על סמך הנתונים שהזנת, זיהינו ${isDeepSleeper ? 'דפוס שינה עמוקה המצריך ליווי צמוד' : 'פוטנציאל גבוה לגמילה מהירה'}. 
                                החבילה המומלצת עבורך היא:
                            </p>
                            
                            <div class="bg-indigo-50 rounded-xl p-8 max-w-lg mx-auto border border-indigo-100 relative">
                                <div class="absolute top-0 right-0 -mt-3 -mr-3 bg-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide shadow-sm">
                                    התאמה של 98%
                                </div>
                                <h3 class="text-2xl font-bold text-slate-900">${product.name}</h3>
                                <p class="text-slate-500 mt-2 mb-6">${product.desc}</p>
                                <div class="text-3xl font-bold text-indigo-600 mb-6">${product.price} ₪</div>
                                <button onclick="addToCart(${product.id}); navigate('store')" class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition shadow-lg shadow-indigo-200">
                                    הוסף לסל והמשך לקופה
                                </button>
                            </div>
                            
                            <button onclick="navigate('store')" class="mt-8 text-slate-500 hover:text-indigo-600 text-sm font-medium underline">
                                הראה לי אפשרויות אחרות
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- STORE LOGIC ---
        function renderStore() {
            return `
                <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-extrabold text-slate-900 sm:text-4xl">חנות הערכות</h2>
                        <p class="mt-4 text-xl text-slate-500">בחרי את רמת הליווי המתאימה לך</p>
                    </div>

                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                        ${state.products.map(p => `
                            <div class="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden hover:shadow-xl transition-shadow flex flex-col relative">
                                ${p.tag ? `<div class="absolute top-4 left-4 bg-indigo-100 text-indigo-800 text-xs font-bold px-2 py-1 rounded">${p.tag}</div>` : ''}
                                <div class="p-6 bg-slate-50 flex-1">
                                    <h3 class="text-xl font-bold text-slate-900">${p.name}</h3>
                                    <p class="mt-2 text-slate-500 text-sm h-12">${p.desc}</p>
                                    <div class="mt-4 flex items-baseline">
                                        <span class="text-3xl font-extrabold text-slate-900">${p.price} ₪</span>
                                    </div>
                                    <ul class="mt-6 space-y-3">
                                        <li class="flex items-center text-sm text-slate-600">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 ml-2"></i>
                                            מכשיר זמזם איכותי
                                        </li>
                                        <li class="flex items-center text-sm text-slate-600">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 ml-2"></i>
                                            משלוח מהיר
                                        </li>
                                        ${p.price > 300 ? `
                                        <li class="flex items-center text-sm text-slate-600">
                                            <i data-lucide="check" class="w-4 h-4 text-green-500 ml-2"></i>
                                            ליווי מומחית
                                        </li>` : ''}
                                    </ul>
                                </div>
                                <div class="p-4 bg-white border-t border-slate-100">
                                    <button onclick="addToCart(${p.id})" class="w-full bg-slate-900 text-white font-bold py-3 rounded-lg hover:bg-slate-800 transition flex items-center justify-center gap-2">
                                        <i data-lucide="shopping-bag" class="w-4 h-4"></i>
                                        הוספה לסל
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div class="mt-16 bg-indigo-900 rounded-3xl p-8 md:p-12 text-center md:text-right md:flex items-center justify-between">
                        <div class="mb-6 md:mb-0">
                            <h3 class="text-2xl font-bold text-white">לא בטוחה מה לבחור?</h3>
                            <p class="text-indigo-200 mt-2">בני לעצמך את הערכה המושלמת בשיטת Mix & Match</p>
                        </div>
                        <button onclick="navigate('builder')" class="bg-white text-indigo-900 font-bold py-3 px-8 rounded-xl shadow-lg hover:bg-indigo-50 transition">
                            למסך הרכבה אישית
                        </button>
                    </div>
                </div>
            `;
        }

        // --- CUSTOM BUILDER LOGIC ---
        function renderBuilder() {
            return `
                <div class="max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
                    <h2 class="text-3xl font-extrabold text-slate-900 mb-8">הרכבת ערכה אישית</h2>
                    
                    <div class="bg-white shadow rounded-lg overflow-hidden mb-8">
                        <div class="p-6 border-b border-slate-200 bg-slate-50">
                            <h3 class="font-bold text-lg">1. מוצר בסיס (חובה)</h3>
                        </div>
                        <div class="p-6">
                            <div class="flex items-center justify-between p-4 border rounded-lg border-indigo-500 bg-indigo-50">
                                <div class="flex items-center">
                                    <input type="radio" checked disabled class="h-4 w-4 text-indigo-600 border-gray-300">
                                    <label class="mr-3 block text-sm font-medium text-slate-700">
                                        מכשיר זמזם בסיסי
                                    </label>
                                </div>
                                <span class="font-bold">180 ₪</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white shadow rounded-lg overflow-hidden">
                        <div class="p-6 border-b border-slate-200 bg-slate-50">
                            <h3 class="font-bold text-lg">2. תוספות ושדרוגים</h3>
                        </div>
                        <div class="divide-y divide-slate-100">
                            ${state.addons.map(addon => `
                                <div class="p-6 flex items-center justify-between hover:bg-slate-50 transition">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="addon-${addon.id}" onchange="toggleBuilderItem(${addon.id}, this.checked)" class="h-5 w-5 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500">
                                        <label for="addon-${addon.id}" class="mr-3 block text-sm text-slate-900 cursor-pointer select-none">
                                            ${addon.name}
                                        </label>
                                    </div>
                                    <span class="text-sm font-bold text-slate-600">+${addon.price} ₪</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mt-8 flex justify-end">
                        <button onclick="addBuilderToCart()" class="bg-indigo-600 text-white font-bold py-4 px-10 rounded-xl shadow-lg hover:bg-indigo-700 transition">
                            הוסף את החבילה המורכבת לסל
                        </button>
                    </div>
                </div>
            `;
        }
        
        // --- BUILDER HELPER ---
        let builderSelection = [5]; // Starts with base product ID
        
        function toggleBuilderItem(id, isChecked) {
            // Mapping addon IDs to fake product IDs for cart logic
            // In a real app, logic would be cleaner
            if (isChecked) {
                // Find or create a temp product object
                const addon = state.addons.find(a => a.id === id);
                if (!state.products.find(p => p.id === id)) {
                    state.products.push({id: id, name: addon.name, price: addon.price, desc: 'תוספת', tag: null});
                }
                builderSelection.push(id);
            } else {
                builderSelection = builderSelection.filter(itemId => itemId !== id);
            }
        }

        function addBuilderToCart() {
            builderSelection.forEach(id => addToCart(id, false));
            toggleCart();
            showToast('החבילה המורכבת נוספה לסל');
            builderSelection = [5]; // Reset
            navigate('store'); // Reset view
        }

        // --- ABOUT PAGE ---
        function renderAbout() {
            return `
                <div class="bg-white py-16 px-4 overflow-hidden sm:px-6 lg:px-8 lg:py-24">
                    <div class="relative max-w-xl mx-auto">
                        <div class="text-center">
                            <h2 class="text-3xl font-extrabold tracking-tight text-slate-900 sm:text-4xl">מי אנחנו</h2>
                            <p class="mt-4 text-lg text-slate-500">יוכבד רבינוביץ - המרכז לגמילה מהרטבת לילה</p>
                        </div>
                        <div class="mt-12">
                            <div class="prose prose-indigo prose-lg text-slate-500 mx-auto">
                                <p>
                                    כבר למעלה מ-15 שנה שאני מלווה הורים וילדים בתהליך הרגיש של גמילה מהרטבת לילה.
                                    מה שהתחיל כיוזמה קטנה בבית, הפך למפעל חיים המספק פתרונות לאלפי משפחות בארץ ובעולם.
                                </p>
                                <p class="mt-4">
                                    השיטה שלנו ייחודית בכך שהיא לא מסתמכת רק על הזמזם (התניה פיזיולוגית), אלא שמה דגש חזק על הפן הרגשי וההתנהגותי.
                                    אנחנו מאמינים שילד שמאמין בעצמו - יצליח להיגמל מהר יותר.
                                </p>
                                <h3 class="mt-6 text-xl font-bold text-slate-900">למה אין סליקה באתר?</h3>
                                <p class="mt-2">
                                    אנו מאמינים בקשר אישי. כל הזמנה שנכנסת למערכת עוברת בדיקה של יועצת.
                                    אנו מוודאים שהזמנתם את הערכה המתאימה לכם ביותר לפני שאנחנו מחייבים אתכם.
                                    התשלום מתבצע בצורה בטוחה בטלפון או בהעברה בנקאית רק לאחר השיחה איתנו.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- CART LOGIC ---
        function addToCart(productId, openDrawer = true) {
            const product = state.products.find(p => p.id === productId);
            state.cart.push(product);
            updateCartUI();
            if (openDrawer) {
                toggleCart();
                showToast(`"${product.name}" נוסף לסל`);
            }
        }

        function removeFromCart(index) {
            state.cart.splice(index, 1);
            updateCartUI();
        }

        function toggleCart() {
            const drawer = document.getElementById('cart-drawer');
            const overlay = drawer.firstElementChild;
            const content = drawer.children[1];
            
            if (drawer.classList.contains('hidden')) {
                drawer.classList.remove('hidden');
                // Small delay for transition
                setTimeout(() => {
                    content.classList.remove('translate-x-full');
                    overlay.classList.remove('opacity-0');
                }, 10);
            } else {
                content.classList.add('translate-x-full');
                overlay.classList.add('opacity-0');
                setTimeout(() => {
                    drawer.classList.add('hidden');
                }, 300);
            }
        }
        
        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function updateCartUI() {
            // Update Badge
            const badge = document.getElementById('cart-badge');
            badge.innerText = state.cart.length;
            if (state.cart.length > 0) badge.classList.remove('opacity-0');
            else badge.classList.add('opacity-0');

            // Update Items List
            const container = document.getElementById('cart-items');
            if (state.cart.length === 0) {
                container.innerHTML = '<div class="text-center text-slate-500 mt-10 flex flex-col items-center"><i data-lucide="shopping-cart" class="w-12 h-12 mb-2 opacity-20"></i>הסל ריק כרגע</div>';
            } else {
                container.innerHTML = state.cart.map((item, index) => `
                    <div class="flex items-center justify-between bg-white p-3 rounded-lg border border-slate-100 shadow-sm animate-pulse-once">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-indigo-50 rounded flex items-center justify-center text-indigo-600 font-bold ml-3 text-sm">
                                ${item.name.charAt(0)}
                            </div>
                            <div>
                                <h4 class="text-sm font-bold text-slate-800">${item.name}</h4>
                                <p class="text-xs text-slate-500">${item.price} ₪</p>
                            </div>
                        </div>
                        <button onclick="removeFromCart(${index})" class="text-red-400 hover:text-red-600 p-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                `).join('');
                lucide.createIcons();
            }

            // Update Total
            const total = state.cart.reduce((sum, item) => sum + item.price, 0);
            document.getElementById('cart-total').innerText = total + ' ₪';
        }

        function checkout() {
            if(state.cart.length === 0) return;
            const total = state.cart.reduce((sum, item) => sum + item.price, 0);
            const itemsList = state.cart.map(i => i.name).join(', ');
            
            // Here you would typically send data to backend
            // For demo, we show success modal
            document.getElementById('cart-drawer').innerHTML = `
                <div class="h-full flex flex-col items-center justify-center p-8 text-center bg-white">
                    <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mb-6">
                        <i data-lucide="check" class="w-10 h-10 text-green-600"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">ההזמנה נקלטה!</h2>
                    <p class="text-slate-600 mb-6">
                        סיכום הזמנה:<br>
                        <strong>${itemsList}</strong><br>
                        סה"כ: ${total} ₪
                    </p>
                    <p class="text-sm text-slate-500">נציגה תיצור איתך קשר בדקות הקרובות להשלמת התשלום.</p>
                    <button onclick="location.reload()" class="mt-8 text-indigo-600 font-bold hover:underline">חזרה לאתר</button>
                </div>
            `;
            lucide.createIcons();
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = msg;
            toast.classList.remove('translate-y-20');
            setTimeout(() => {
                toast.classList.add('translate-y-20');
            }, 3000);
        }

        // Initialize
        navigate('home');

    </script>
</body>
</html>
